<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction Result</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        h1, h2 {
            color: #333;
        }
        p {
            font-size: 1.1em;
        }
        a {
            display: inline-block;
            margin-top: 20px;
            text-decoration: none;
            color: white;
            background-color: #007bff;
            padding: 10px 20px;
            border-radius: 5px;
        }
        a:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Predicted Result</h1>

    <p><strong>Input Text:</strong> {{ text }}</p>
    <p><strong>Algorithm:</strong> {{ model }}</p>
    <p><strong>Predicted Language:</strong> {{ prediction }}</p>
    <br><br>
    <h1>Model Metrics Comparison (All Models)</h1>
    <br>
    <h3>Accuracy Comparison</h3>
    <canvas id="accuracyChart" width="200" height="100"></canvas>

    <h3>F1 Score Comparison</h3>
    <canvas id="f1Chart" width="200" height="100"></canvas>

    <h3>Precision Comparison</h3>
    <canvas id="precisionChart" width="200" height="100"></canvas>

    <h3>Recall Comparison</h3>
    <canvas id="recallChart" width="200" height="100"></canvas>

    <script>
        const labels = JSON.parse('{{ labels|tojson|safe }}');
        const accuracyValues = JSON.parse('{{ accuracy_values|tojson|safe }}');
        const f1Values = JSON.parse('{{ f1_values|tojson|safe }}');
        const precisionValues = JSON.parse('{{ precision_values|tojson|safe }}');
        const recallValues = JSON.parse('{{ recall_values|tojson|safe }}');
        const modelColors = [
            'rgba(54, 162, 235, 0.7)',
            'rgba(75, 192, 192, 0.7)',
            'rgba(255, 159, 64, 0.7)',
            'rgba(153, 102, 255, 0.7)',
            'rgba(255, 99, 132, 0.7)'
        ];

        const chartsConfig = [
            {id: 'accuracyChart', label: 'Accuracy', data: accuracyValues},
            {id: 'f1Chart', label: 'F1 Score', data: f1Values},
            {id: 'precisionChart', label: 'Precision', data: precisionValues},
            {id: 'recallChart', label: 'Recall', data: recallValues}
        ];

        chartsConfig.forEach(cfg => {
            const ctx = document.getElementById(cfg.id).getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: cfg.label,
                        data: cfg.data,
                        backgroundColor: modelColors.slice(0, labels.length)
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'end',
                            color: '#000',
                            font: { size: 12 },
                            formatter: value => value.toFixed(4)
                        }
                    },
                    scales: {
                        y: { beginAtZero: true, max: 1 }
                    }
                },
                plugins: [ChartDataLabels]
            });
        });
    </script>


    <a href="/">Back</a>
</body>
</html>
